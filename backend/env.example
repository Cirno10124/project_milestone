############################################################
# Project Milestone Backend - 示例环境变量文件（可提交）
#
# 使用方法：
#   复制本文件为 backend/.env，然后按需修改
#
# 注意：
# - 仓库根目录 .gitignore 会忽略任何目录下的 .env 文件
# - 本文件不包含敏感值，仅提供变量名与示例
############################################################

# Server
PORT=3000
# 允许跨域的前端地址（支持逗号分隔多个 Origin）
# 示例（本机 + 局域网访问）：
# CORS_ORIGIN=http://localhost:5173,http://192.168.0.109:5173
# 开发兜底（不建议生产）：
# CORS_ORIGIN=*
CORS_ORIGIN=http://localhost:5173

# Database (MySQL)
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=password
DB_NAME=project_milestone

# Auth
JWT_SECRET=changeme

# Optional: 注册该用户名时，自动设置为超级管理员
SUPER_ADMIN_USERNAME=admin

############################################################
# Email Verification Code (Redis)
############################################################
# Redis connection (preferred)
REDIS_URL=redis://127.0.0.1:6379
# Or split config
# REDIS_HOST=127.0.0.1
# REDIS_PORT=6379
# REDIS_PASSWORD=

# Email code policy
EMAIL_CODE_TTL_SECONDS=600
EMAIL_CODE_COOLDOWN_SECONDS=60
EMAIL_CODE_MAX_ATTEMPTS=5
EMAIL_CODE_SECRET=email_code_secret_change_me

# Password reset token policy
PASSWORD_RESET_TOKEN_TTL_SECONDS=900

############################################################
# SMTP
############################################################
# 邮件发送通道：smtp（默认）或 http（邮件 API / 自建中转）
# EMAIL_SENDER_PROVIDER=http
# 通用 HTTP 邮件 API 端点（你可以用云函数/中转服务适配任意邮件厂商）
# 请求体示例：
#   { "from": "Projects <cirno_10124@qq.com>", "to": "xxx@gmail.com", "subject": "...", "text": "..." }
# EMAIL_HTTP_ENDPOINT=https://your-email-relay.example.com/send
# 可选：Bearer Token（若你的中转服务需要鉴权）
# EMAIL_HTTP_BEARER_TOKEN=change_me
# 可选：鉴权 Header 名称（默认 Authorization）
# EMAIL_HTTP_AUTH_HEADER=Authorization
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_SECURE=false
# 对 587（STARTTLS）建议开启（代码里默认：587 且非 secure 会自动 requireTLS）
# SMTP_REQUIRE_TLS=true
SMTP_USER=your_account@example.com
SMTP_PASS=your_password
FROM_EMAIL=your_account@example.com
FROM_NAME=Project Milestone

############################################################
# Dev-only: 邮件联调兜底（生产环境不要开启）
############################################################
# 禁用真实发信，直接把验证码打印到后端日志（用于功能可用性测试）
# DEV_EMAIL_SENDER=console
# 可选：把验证码回传给前端响应（生产环境不要开启）
# DEV_RETURN_EMAIL_CODE=1

# Dev-only: 提权接口 /dev/make-super-admin
DEV_ADMIN_SECRET=dev_secret_change_me
# Dev-only: 非生产环境开启 header 调试打印（1=开启）
DEV_SECRET_DEBUG=0

